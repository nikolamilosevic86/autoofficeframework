<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Autoofficeframework - C++ framework for automating office</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="keywords" content="Microsoft office, automation, C++, OLE, COM, Component object model, Word, Excel, Word automation, Excel automation">
	<meta name="author" content="Nikola Milosevic">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Autoofficeframework</h1>
        <p>Framework that uses Component Object Model via C++ MFC to interact with MS Office applications. </p>

        <p class="view"><a href="https://github.com/nikolamilosevic86/autoofficeframework">View the Project on GitHub <small>nikolamilosevic86/autoofficeframework</small></a></p>


        <ul>
          <li><a href="https://github.com/nikolamilosevic86/autoofficeframework/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/nikolamilosevic86/autoofficeframework/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/nikolamilosevic86/autoofficeframework">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="autoofficeframework" class="anchor" href="#autoofficeframework" aria-hidden="true"><span class="octicon octicon-link"></span></a>AutoOfficeFramework</h1>

<p>Framework classes for C++ that uses Component Object Model to interact with MS Office applications. The code can be used with any native or .NET C++ application.</p>

<p>The framework is able to start new MS Word and MS Excel (PowerPoint is not supported in current version) process, to create document, write into document, add picture, add comment, read document (usable for templates that has to be changed with some other content automatically) and many more.</p>

<p>Pre-requirements: Installed MS Office on machine.</p>

<p>Developed in Visual Studio 2008 (Should work with Visual C++ 2008 and later). The project cannot be compiled in Visual Studio express edition, because it doesn't support MFC projects.</p>

<h1>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h1>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>Auto Office Frmaevork is framework for automating functions of MS Office applications. It works via Component Object Model, and via COM interfaces interacts with MS Office Functions. First realease version supports large scale of MS Word functionlaity, and some functionality of MS Excel. Other programs from MS Office will be supported in later versions. Also Auto Office Framework is supported in all versions of MS Office since MS Office 2003 (tested), and maybe earlier (not tested).</p>

<h2>
<a id="motivation" class="anchor" href="#motivation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation</h2>

<p>Many applications can be extended to create reports, or to use MS Office documents. It can be used for reports, or can be used as templates for creating documents reading some database. There are some frameworks for interaction with MS Office applications but in languages like Java or .NET programming languages. If someone want to interact with MS Office via native C++, there is a problem. To solve that problem is created Auto Office Framework for MFC C++.</p>

<h2>
<a id="details" class="anchor" href="#details" aria-hidden="true"><span class="octicon octicon-link"></span></a>Details</h2>

<p>The library contains classes for each office applications that are able to ineract with that MS Office component. In first (0.1) version of Auto Office Framework there are just two, CMSWord and CMSExcel classes. CMSWord class is used to interact with MS Office Word application. This is the class interface that can be used:</p>

<pre><code>class CMSWord
 {
 protected:
         IDispatch*      m_pWApp;
         IDispatch*  m_pDocuments;
         IDispatch*      m_pActiveDocument;
         IDispatch*  pDocApp;
         HRESULT         m_hr;
         HRESULT Initialize(bool bVisible=true);
 public:
         //Constructor creates a instance of object
         CMSWord();
         //Destructor
         ~CMSWord();
         //Sets visibility of active document
         HRESULT SetVisible(bool bVisible=true);
         //Quits the MS Word. Closes process
         HRESULT Quit();
         //Opens document and set document's visibility
         HRESULT OpenDocument(LPCTSTR szFilename, bool bVisible=true);
         //Open new empty document
         HRESULT NewDocument(bool bVisible=true);
         //Closes active document with or without saving
         HRESULT CloseActiveDocument(bool bSave=true);
         //Finds first next text in active document as specified 
         HRESULT FindFirst(LPCTSTR szText);
         //Finds first next text in active document as specified. Returns false if end of document reached.
         bool FindFirstBool(LPCTSTR szText);
         //Close all documents
         HRESULT CloseDocuments(bool bSave=true);
         //Copies selected text into clipboard
         HRESULT Copy();
         //Pastes from Clipboard to active document
         HRESULT Paste();
         //Activate document by specified id
         HRESULT ActivateDocumentById(int id);
         //Returns number of opened documents in the process. There can be more MS Word processes, and the framework won't see documents controled by other processes.
         int CountDocuments();
         //Sets selected text. Replace it with specified text.
         HRESULT SetSelectionText(LPCTSTR szText);
         //Inserts picture from path specified in argument.
         HRESULT InserPicture(LPCTSTR szFilename);
         //Inserts text in active document.
         HRESULT InserText(LPCTSTR szText);
         // Inserts MS Word file into active document with all formating.
         HRESULT InsertFile(LPCTSTR szFilename);
         //Adds comment in ballon. Text is specified in argument
         HRESULT AddComment(LPCTSTR szComment);
         //Moves cursor. 2 is forward, 1 i backward. Selection is true then it selects text as it moves
         HRESULT MoveCursor(int nDirection=2,bool bSelection=false);
         //Delete char forward or backward
         HRESULT DeleteChar(bool bBack=false);
         //Sets bold for next inserted chars or for selected text.
         HRESULT SetBold(bool bBold=false);
         //Sets italic for next inserted chars or for selected text.
         HRESULT SetItalic(bool bItalic=false);
         //Sets underline for next inserted chars or for selected text.
         HRESULT SetUnderline(bool bUnderline=false);
         //Check spelling
         HRESULT CheckSpelling(LPCTSTR szWord, bool &amp;bResult);
         //check grammer
         HRESULT CheckGrammer(LPCTSTR szString, bool &amp;bResult);
         //sets font as specified
         HRESULT SetFont(LPCTSTR szFontName, int nSize, bool bBold, bool bItalic,COLORREF crColor);
         //Gets string of specified size
         CString GetString(int nlenght);
         //Get selected string
         CString GetSelectedString();
         //Saves file
         HRESULT SaveFile(LPCTSTR czFileName);
 };
</code></pre>

<p>Interface of CMSExcel class is:</p>

<pre><code>class CMSExcel
{
protected:
        HRESULT m_hr;
        IDispatch*      m_pEApp;
        IDispatch*  m_pBooks;
        IDispatch*      m_pActiveBook;
private:
        HRESULT Initialize(bool bVisible=true);
public:
        CMSExcel(void);
        ~CMSExcel(void);
        HRESULT SetVisible(bool bVisible=true);
        HRESULT NewExcelBook(bool bVisible=true);
        HRESULT OpenExcelBook(LPCTSTR szFilename, bool bVisible=true);
        HRESULT SaveAs(LPCTSTR szFilename, int nSaveAs=40);
        HRESULT ProtectExcelWorkbook(LPCTSTR szPassword);
        HRESULT UnProtectExcelWorkbook(LPCTSTR szPassword);
        HRESULT ProtectExcelSheet(int nSheetNo, LPCTSTR szPassword);
        HRESULT UnProtectExcelSheet(int nSheetNo, LPCTSTR szPassword);
        HRESULT SetExcelCellFormat(LPCTSTR szRange, LPCTSTR szFormat);
        HRESULT SetExcelSheetName(int nSheetNo, LPCTSTR szSheetName);
        HRESULT GetExcelValue(LPCTSTR szCell, CString &amp;sValue);
        HRESULT SetExcelBackgroundColor(LPCTSTR szRange, COLORREF crColor, int nPattern);
        HRESULT SetExcelFont(LPCTSTR szRange, LPCTSTR szName, int nSize, COLORREF crColor, bool bBold, bool bItalic);
        HRESULT SetExcelValue(LPCTSTR szRange,LPCTSTR szValue,bool bAutoFit, int nAlignment);
        HRESULT SetExcelBorder(LPCTSTR szRange, int nStyle);
        HRESULT MergeExcelCells(LPCTSTR szRange);
        HRESULT AutoFitExcelColumn(LPCTSTR szColumn);
        HRESULT AddExcelChart(LPCTSTR szRange, LPCTSTR szTitle, int nChartType, int nLeft, int nTop, int nWidth, int nHeight, int nRangeSheet, int nChartSheet);
        HRESULT MoveCursor(int nDirection);
        HRESULT GetActiveCell(int &amp;nRow, int &amp;nCol);
        HRESULT SetActiveCellText(LPCTSTR szText);
        HRESULT Quit();
};
</code></pre>

<p>Also all of this methods from classes uses OLEMethod function. This is the function that uses COM to gain access to some remote objects and to invoke methods or to get or set some property. Coding in COM requires a lot of code, and this function enables to reuse the great amount of that code.</p>

<h1>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h1>

<p>This project is created by Nikola Milosevic (<a href="https://github.com/nikolamilosevic86" class="user-mention">@nikolamilosevic86</a>), as his BSc project at the School of Electrical Engineering, University of Belgrade.</p>

<h1>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support or Contact</h1>

<p>Having trouble with this project? Contact us <a href="mailto:nikola.milosevic@manchester.ac.uk">nikola.milosevic@manchester.ac.uk</a> and weâ€™ll help you sort it out.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/nikolamilosevic86">nikolamilosevic86</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
